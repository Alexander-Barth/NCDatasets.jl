<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Known issues · NCDatasets.jl</title><meta name="title" content="Known issues · NCDatasets.jl"/><meta property="og:title" content="Known issues · NCDatasets.jl"/><meta property="twitter:title" content="Known issues · NCDatasets.jl"/><meta name="description" content="Documentation for NCDatasets.jl."/><meta property="og:description" content="Documentation for NCDatasets.jl."/><meta property="twitter:description" content="Documentation for NCDatasets.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="NCDatasets.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NCDatasets.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../dataset/">Datasets</a></li><li><a class="tocitem" href="../dimensions/">Dimensions</a></li><li><a class="tocitem" href="../variables/">Variables</a></li><li><a class="tocitem" href="../attributes/">Attributes</a></li><li><a class="tocitem" href="../performance/">Performance tips</a></li><li><a class="tocitem" href="../other/">Other features</a></li><li class="is-active"><a class="tocitem" href>Known issues</a><ul class="internal"><li><a class="tocitem" href="#NetCDF:-Not-a-valid-data-type-or-_FillValue-type-mismatch"><span>NetCDF: Not a valid data type or <code>_FillValue</code> type mismatch</span></a></li><li><a class="tocitem" href="#Defining-the-attributes-_FillValue,-add_offset,-scale_factor,-units-and-calendar"><span>Defining the attributes <code>_FillValue</code>, <code>add_offset</code>, <code>scale_factor</code>, <code>units</code> and <code>calendar</code></span></a></li><li><a class="tocitem" href="#Multiple-versions-of-HDF5-or-NetCDF-libraries"><span>Multiple versions of HDF5 or NetCDF libraries</span></a></li><li><a class="tocitem" href="#Using-a-custom-NetCDF-library"><span>Using a custom NetCDF library</span></a></li><li><a class="tocitem" href="#OPeNDAP-on-Windows-fails-with-Assertion-failed:-ocpanic"><span>OPeNDAP on Windows fails with <code>Assertion failed: ocpanic</code></span></a></li><li><a class="tocitem" href="#Using-non-official-julia-builds"><span>Using non-official julia builds</span></a></li><li><a class="tocitem" href="#version-CURL_4&#39;-not-found"><span>version `CURL_4&#39; not found</span></a></li><li><a class="tocitem" href="#Corner-cases"><span>Corner cases</span></a></li></ul></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Known issues</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Known issues</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Alexander-Barth/NCDatasets.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Alexander-Barth/NCDatasets.jl/blob/master/docs/src/issues.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Known-issues"><a class="docs-heading-anchor" href="#Known-issues">Known issues</a><a id="Known-issues-1"></a><a class="docs-heading-anchor-permalink" href="#Known-issues" title="Permalink"></a></h1><h2 id="NetCDF:-Not-a-valid-data-type-or-_FillValue-type-mismatch"><a class="docs-heading-anchor" href="#NetCDF:-Not-a-valid-data-type-or-_FillValue-type-mismatch">NetCDF: Not a valid data type or <code>_FillValue</code> type mismatch</a><a id="NetCDF:-Not-a-valid-data-type-or-_FillValue-type-mismatch-1"></a><a class="docs-heading-anchor-permalink" href="#NetCDF:-Not-a-valid-data-type-or-_FillValue-type-mismatch" title="Permalink"></a></h2><p>Trying to define the <code>_FillValue</code>, produces the following error:</p><pre><code class="nohighlight hljs">ERROR: LoadError: NCDatasets.NetCDFError(-45, &quot;NetCDF: Not a valid data type or _FillValue type mismatch&quot;)</code></pre><p>The error could be generated by a code like this:</p><pre><code class="language-julia hljs">using NCDatasets, DataStructures
# ...
tempvar = defVar(ds,&quot;temp&quot;,Float32,(&quot;lonc&quot;,&quot;latc&quot;,&quot;time&quot;), attrib = OrderedDict(
    &quot;_FillValue&quot; =&gt; -9999.))</code></pre><p>or</p><pre><code class="language-julia hljs">using NCDatasets
# ...
tempvar = defVar(ds,&quot;temp&quot;,Float32,(&quot;lonc&quot;,&quot;latc&quot;,&quot;time&quot;), fillvalue = -9999.)</code></pre><p>In fact, <code>_FillValue</code> must have the same data type as the corresponding variable. In the case above, <code>tempvar</code> is a 32-bit float and the number <code>-9999.</code> is a 64-bit float (aka double, which is the default floating point type in Julia). It is sufficient to convert the value <code>-9999.</code> to a 32-bit float <code>-9999.f0</code> (or <code>Float32(-9999.)</code>).</p><h2 id="Defining-the-attributes-_FillValue,-add_offset,-scale_factor,-units-and-calendar"><a class="docs-heading-anchor" href="#Defining-the-attributes-_FillValue,-add_offset,-scale_factor,-units-and-calendar">Defining the attributes <code>_FillValue</code>, <code>add_offset</code>, <code>scale_factor</code>, <code>units</code> and <code>calendar</code></a><a id="Defining-the-attributes-_FillValue,-add_offset,-scale_factor,-units-and-calendar-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-attributes-_FillValue,-add_offset,-scale_factor,-units-and-calendar" title="Permalink"></a></h2><p>An error like <code>Cannot</code><code>convert</code><code>an object of type Missing</code> (or similar) is generated by code like this:</p><pre><code class="language-julia hljs">v = defVar(ds,&quot;var_with_all_missing_data&quot;,Float32,(&quot;lon&quot;,))
v.attrib[&quot;_FillValue&quot;] = fv
v[1] = missing</code></pre><p>This produces the following error:</p><pre><code class="nohighlight hljs">ERROR: LoadError: MethodError: Cannot `convert` an object of type Missing to an object of type Float32
Closest candidates are:
  convert(::Type{T}, ::T) where T&lt;:Number at number.jl:6
  convert(::Type{T}, ::Number) where T&lt;:Number at number.jl:7
  convert(::Type{T}, ::Base.TwicePrecision) where T&lt;:Number at twiceprecision.jl:250
  ...
Stacktrace:
 [1] fill!(::SubArray{Float32,1,NCDatasets.CFVariable{Float32,1,NCDatasets.Variable{Float32,1},NCDatasets.Attributes},Tuple{UnitRange{Int64}},false}, ::Missing) at ./multidimensional.jl:865
 [2] copyto! at ./broadcast.jl:871 [inlined]
 [3] materialize!(::SubArray{Float32,1,NCDatasets.CFVariable{Float32,1,NCDatasets.Variable{Float32,1},NCDatasets.Attributes},Tuple{UnitRange{Int64}},false}, ::Base.Broadcast.Broadcasted{Base.Broadcast.DefaultArrayStyle{0},Nothing,typeof(identity),Tuple{Base.RefValue{Missing}}}) at ./broadcast.jl:822</code></pre><p>One should use define the <code>_FillValue</code> (and similar attributes like <code>add_offset</code>, <code>scale_factor</code>, <code>units</code> and <code>calendar</code> affecting the type of the data) in the call of <code>defVar</code>:</p><pre><code class="language-julia hljs">using DataStructures
v = defVar(ds,&quot;var_with_all_missing_data&quot;,Int32,(&quot;lon&quot;,), fillvalue = fv, attrib = OrderedDict(
    &quot;scale_factor&quot; =&gt; 0.1,
    &quot;add_offset&quot; =&gt; 0.1
    ))</code></pre><p>This change was introduced in <code>NCDatasets</code> version 0.10</p><h2 id="Multiple-versions-of-HDF5-or-NetCDF-libraries"><a class="docs-heading-anchor" href="#Multiple-versions-of-HDF5-or-NetCDF-libraries">Multiple versions of HDF5 or NetCDF libraries</a><a id="Multiple-versions-of-HDF5-or-NetCDF-libraries-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-versions-of-HDF5-or-NetCDF-libraries" title="Permalink"></a></h2><p>Having outdated versions of HDF5 or NetCDF libraries installed can be an issue on Windows if they are included in the system <code>PATH</code> environment variable. It is advised to adapt the system <code>PATH</code> to remove the locations containing these libraries.</p><h2 id="Using-a-custom-NetCDF-library"><a class="docs-heading-anchor" href="#Using-a-custom-NetCDF-library">Using a custom NetCDF library</a><a id="Using-a-custom-NetCDF-library-1"></a><a class="docs-heading-anchor-permalink" href="#Using-a-custom-NetCDF-library" title="Permalink"></a></h2><p>The NetCDF library <code>libnetcdf.so</code> is installed as an artifact via the package <a href="https://github.com/JuliaBinaryWrappers/NetCDF_jll.jl">NetCDF_jll</a>. You can override which <code>libnetcdf.so</code> gets loaded through the <code>Preferences</code> package, as follows:</p><pre><code class="language-julia hljs"># install these packages if necessary
using Preferences, NetCDF_jll

set_preferences!(NetCDF_jll, &quot;libnetcdf_path&quot; =&gt; &quot;/path/to/libnetcdf.so.xyz&quot;)</code></pre><p>where <code>/path/to/libnetcdf.so.xyz</code> is the full path to the NetCDF library. This will create a <code>LocalPreferences.toml</code> file in your top-level project with the following content:</p><pre><code class="nohighlight hljs">[NetCDF_jll]
libnetcdf_path = &quot;/path/to/libnetcdf.so.xyz&quot;</code></pre><p>However, the dependencies of the library version <code>libnetcdf.so.xyz</code> (in particular <code>libcurl.so</code> and <code>libmbedtls.so</code>) should be compatible with the dependencies of julia (in the folder <code>.../julia-x.y.z/lib/julia</code>). On Linux, you can list the library dependencies with the shell command <code>ldd</code>, for example:</p><pre><code class="language-bash hljs">ldd /path/to/libnetcdf.so.xyz</code></pre><h2 id="OPeNDAP-on-Windows-fails-with-Assertion-failed:-ocpanic"><a class="docs-heading-anchor" href="#OPeNDAP-on-Windows-fails-with-Assertion-failed:-ocpanic">OPeNDAP on Windows fails with <code>Assertion failed: ocpanic</code></a><a id="OPeNDAP-on-Windows-fails-with-Assertion-failed:-ocpanic-1"></a><a class="docs-heading-anchor-permalink" href="#OPeNDAP-on-Windows-fails-with-Assertion-failed:-ocpanic" title="Permalink"></a></h2><p>On windows, NetCDF 4.7.4 can fail with this error:</p><pre><code class="nohighlight hljs">Assertion failed: ocpanic((&quot;state-&gt;auth.curlflags.cookiejar != NULL&quot;)), file ocinternal.c, line 566</code></pre><p>when accessing OPeNDAP URLs, like these:</p><pre><code class="language-julia hljs">using NCDatasets
ds = NCDataset(&quot;https://thredds.jpl.nasa.gov/thredds/dodsC/ncml_aggregation/OceanTemperature/modis/terra/11um/4km/aggregate__MODIS_TERRA_L3_SST_THERMAL_DAILY_4KM_DAYTIME_V2019.0.ncml#fillmismatch&quot;)</code></pre><p>See also the issue report: <a href="https://github.com/Unidata/netcdf-c/issues/2380">https://github.com/Unidata/netcdf-c/issues/2380</a>. The work-around is to create a <code>.dodsrc</code> in the current working directory with the content:</p><pre><code class="nohighlight hljs">HTTP.COOKIEJAR=C:\Users\USERNAME\AppData\Local\Temp\</code></pre><p>where USERNAME is your username. The directory should exist and be writable by the user. You can run <code>pwd()</code> to determine the current working directory. Note that the initial current working directory can be different depending you how you start julia (from the command line or from jupyter notebook for example). Julia need to be restarted after this file is placed in the your working directory.</p><h2 id="Using-non-official-julia-builds"><a class="docs-heading-anchor" href="#Using-non-official-julia-builds">Using non-official julia builds</a><a id="Using-non-official-julia-builds-1"></a><a class="docs-heading-anchor-permalink" href="#Using-non-official-julia-builds" title="Permalink"></a></h2><p>Julia and <a href="https://github.com/JuliaBinaryWrappers/NetCDF_jll.jl">NetCDF_jll</a> have several common dependencies (curl, MbedTLS, zlib). Non-official julia builds will work only if they use exactly the same library version as those used to compile NetCDF. This is unlikely to be the case in general and outside of our control. Therefore non-official julia builds are not supported. Official julia builds are available at <a href="https://julialang.org/downloads/">https://julialang.org/downloads/</a>.</p><p>Using for example the <a href="https://wiki.archlinux.org/title/Julia">julia package from on Arch Linux</a>, leads to this error:</p><pre><code class="nohighlight hljs">julia&gt; using NCDatasets
ERROR: LoadError: InitError: could not load library &quot;/root/.julia/artifacts/461703969206dd426cc6b4d99f69f6ffab2a9779/lib/libnetcdf.so&quot;
/usr/lib/julia/libcurl.so: version `CURL_4&#39; not found (required by /root/.julia/artifacts/461703969206dd426cc6b4d99f69f6ffab2a9779/lib/libnetcdf.so)
Stacktrace:
 [1] macro expansion
   @ ~/.julia/packages/JLLWrappers/QpMQW/src/products/library_generators.jl:54 [inlined]
 [2] __init__()
   @ NetCDF_jll ~/.julia/packages/NetCDF_jll/BYHmI/src/wrappers/x86_64-linux-gnu.jl:12
 [3] top-level scope
   @ stdin:1
during initialization of module NetCDF_jll</code></pre><p>You will likely have similar issues with julia installed from other package managers (like Debian/Ubuntu apt, Homebrew...). The only supported solution is to install the <a href="https://julialang.org/downloads/">offical julia builds</a>.</p><h2 id="version-CURL_4&#39;-not-found"><a class="docs-heading-anchor" href="#version-CURL_4&#39;-not-found">version `CURL_4&#39; not found</a><a id="version-CURL_4&#39;-not-found-1"></a><a class="docs-heading-anchor-permalink" href="#version-CURL_4&#39;-not-found" title="Permalink"></a></h2><p>If you see the following error:</p><pre><code class="nohighlight hljs">ERROR: LoadError: InitError: could not load library &quot;/home/user/.julia/artifacts/461703969206dd426cc6b4d99f69f6ffab2a9779/lib/libnetcdf.so&quot;
/usr/lib/x86_64-linux-gnu/libcurl.so: version `CURL_4&#39; not found (required by /home/user/.julia/artifacts/461703969206dd426cc6b4d99f69f6ffab2a9779/lib/libnetcdf.so)</code></pre><p>make sure that you are using the <a href="https://julialang.org/downloads/">offical julia builds</a> (see above) and that your <code>LD_LIBRARY_PATH</code> and <code>LD_PRELOAD</code> are empty. You can verify this by running the following commands in a terminal:</p><pre><code class="language-bash hljs">echo $LD_PRELOAD
echo $LD_LIBRARY_PATH</code></pre><h2 id="Corner-cases"><a class="docs-heading-anchor" href="#Corner-cases">Corner cases</a><a id="Corner-cases-1"></a><a class="docs-heading-anchor-permalink" href="#Corner-cases" title="Permalink"></a></h2><ul><li><p>An attribute representing a vector with a single value (e.g. <code>[1]</code>) will be read back as a scalar (<code>1</code>) (same behavior in python netCDF4 1.3.1).</p></li><li><p>NetCDF and Julia distinguishes between a vector of chars and a string, but both are returned as string for ease of use, in particular an attribute representing a vector of chars <code>[&#39;u&#39;,&#39;n&#39;,&#39;i&#39;,&#39;t&#39;,&#39;s&#39;]</code> will be read back as the string <code>&quot;units&quot;</code>.</p></li><li><p>While reading a NetCDF time variable, the dates are converted using the Julia&#39;s <code>DateTime</code> (based on the proleptic Gregorian calendar following the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> standard) when possible. When data is written to a NetCDF file (without specifying the calendar), the dates are saved using the default calendar of the NetCDF CF convention (the mixed Julian/Gregorian calendar, called <code>&quot;standard&quot;</code>) when possible. It is recommended that the time origin specified by the units is after 15 October 1582 in which case the mixed Julian/Gregorian calendar is identical to the proleptic Gregorian calendar.</p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../other/">« Other features</a><a class="docs-footer-nextpage" href="../tutorials/">Tutorials »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 15 January 2024 16:06">Monday 15 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
